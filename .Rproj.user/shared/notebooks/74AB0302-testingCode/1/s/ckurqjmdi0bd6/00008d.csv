"0","X_test <- data_test[, covariates, with = FALSE]"
"0","Y_test <- data_test$Y"
"0","f_test <- predictor(X_test)"
"0",""
"0","# conformal prediction"
"0","cf_preds <- conformal_predict(out, f_test)"
"0","cf_preds$true <- Y_test"
"0","f_cal_bins <- quantile(cf_preds$f_cal, seq(0, 1, length = 20), type = 1)"
"0","cf_preds$bins <-  findInterval(cf_preds$f_cal, f_cal_bins, all.inside = TRUE)"
"0","sigma2_bins <- quantile(data_test$sigma2, seq(0, 1, length = 20), type = 1)"
"0","cf_preds$bins <-  findInterval(data_test$sigma2, sigma2_bins, all.inside = TRUE)"
"0",""
"0","data_coverage <- cf_preds[, .(n = .N, coverage = mean(true >= left & true <= right)) , by = bins]"
"0",""
"0","print(data_coverage)"
